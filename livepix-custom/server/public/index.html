<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>Meu LivePix</title>
  <style>
    body{font-family:Arial;background:#f5f5f5;display:flex;justify-content:center;padding-top:60px}
    .card{background:#fff;padding:30px;border-radius:12px;box-shadow:0 6px 20px rgba(0,0,0,0.08);width:360px}
    input, textarea{width:100%;padding:10px;margin-bottom:10px;border:1px solid #ddd;border-radius:6px}
    button{width:100%;padding:12px;border:none;border-radius:8px;background:#0069d9;color:#fff;font-weight:bold;font-size:16px}
    #qr{margin-top:20px;text-align:center;display:none}
  </style>
</head>
<body>
  <div class="card">
    <h2>Enviar Pix</h2>
    <input id="nome" placeholder="Seu nome">
    <textarea id="mensagem" placeholder="Mensagem"></textarea>
    <input id="valor" placeholder="Valor ex: 2.50">
    <button onclick="pagar()">Gerar Pix</button>

    <div id="qr">
      <img id="qrimg" style="width:260px">
      <p id="pixcode" style="font-size:12px;word-break:break-all"></p>
    </div>
  </div>

<script>
async function pagar() {
  const nome = document.getElementById('nome').value;
  const mensagem = document.getElementById('mensagem').value;
  const valor = Number(document.getElementById('valor').value.replace(',', '.')) * 100;

  const resp = await fetch('/.netlify/functions/create-charge', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({ nome, mensagem, valor })
  });

  const data = await resp.json();

  document.getElementById('qrimg').src = data.qrDataUrl;
  document.getElementById('pixcode').innerText = data.pixString;
  document.getElementById('qr').style.display = 'block';
}
</script>

</body>
</html>
